const { Client } = require('discord.js');
const env = require('./util/envparser');
const { sendMessage, getCommands } = require('./commands/message');
const client = new Client({ intents: ['GUILDS', 'GUILD_MESSAGES'] });
require('dotenv').config()

if (!env.isVaild()) {
    console.error(`[!] .Env File is empty or missing!`);
}

const botToken = env.botToken;
const prefix = env.prefix;

client.login(botToken);

client.on('ready', () => {
    console.log(`Logged in as ${client.user.tag}!`);
});

client.on('messageCreate', message => {

    if (message.author.bot) return;
    if (!message.content.startsWith(prefix)) return;

    let body = message.content.slice(prefix.length);
    let args = body.split(" ");
    let command = args.shift().toLowerCase();
    let user = "@" + message.author.username + "#" + message.author.discriminator;

    if (command === "cmd") {
        sendMessage(
            message,
            "My Commands",
            "#FFA500",
            `Here are all my **commands** :- \n ${getCommands()}`
        );

    }

});


const discord = require("discord.js");

function sendMessage(
    message,
    title,
    color,
    description
) {
    let msg = new discord.MessageEmbed()
        .setTitle(title)
        .setColor(color)
        .setDescription(description)
        .setTimestamp();

    message.channel.send({ embeds: [msg] });
};

function getCommands() {
    return `1] !**meme** *Get random meme from famous subreddits* \n` +
        `2] !**memz** *Get meme from the subreddit of the bot owner*`;
}

module.exports = {
    sendMessage,
    getCommands
};

require('dotenv').config()

const botToken = process.env.DISCORD_BOT_TOKEN || undefined;
const prefix = process.env.PREFIX || undefined;


module.exports.isVaild = function () {
    if (!botToken) return false;
    if (!prefix) return false;

    return true;
}

module.exports.botToken = botToken;
module.exports.prefix = prefix;
